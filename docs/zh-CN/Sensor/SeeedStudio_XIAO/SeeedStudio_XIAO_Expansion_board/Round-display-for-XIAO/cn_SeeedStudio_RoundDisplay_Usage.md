---
description: æœ¬æ•™ç¨‹ä»‹ç»åœ†å½¢å±å¹•æ‰©å±•æ¿åŠŸèƒ½çš„ä½¿ç”¨ã€‚
title: ç¡¬ä»¶ä½¿ç”¨
keywords:
- Round display
- XIAO
image: https://files.seeedstudio.com/wiki/seeed_logo/logo_2023.png
slug: /cn/seeedstudio_round_display_usage
last_update:
  date: 04/27/2023
  author: Citric
---

# Seeed Studio åœ†å½¢æ˜¾ç¤ºå±æ‰©å±•æ¿çš„ä½¿ç”¨

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/79.jpg" style={{width:800, height:'auto'}}/></div>

<div class="get_one_now_container" style={{textAlign: 'center'}}>
    <a class="get_one_now_item" href="https://www.seeedstudio.com/Seeed-Studio-Round-Display-for-XIAO-p-5638.html" target="_blank">
            <strong><span><font color={'FFFFFF'} size={"4"}> ç«‹å³è´­ä¹° ğŸ–±ï¸</font></span></strong>
    </a>
</div>

<br />

æœ¬æ•™ç¨‹å°†è¯¦ç»†è¯´æ˜å¦‚ä½•ä½¿ç”¨åœ†å½¢æ˜¾ç¤ºå±ä¸Šçš„æ‰©å±•åŠŸèƒ½ï¼ŒåŒ…æ‹¬RTCåŠŸèƒ½ã€SDå¡åŠŸèƒ½å’Œå±å¹•åŠŸèƒ½çš„ä½¿ç”¨ã€‚

## å…¥é—¨æŒ‡å—

æœ¬æ•™ç¨‹çš„å†…å®¹æ”¯æŒæ‰€æœ‰XIAOç³»åˆ—äº§å“ã€‚å› æ­¤æ‚¨å¯ä»¥ä½¿ç”¨ä»»ä½•XIAOæ¥å®Œæˆæœ¬Wikiçš„å†…å®¹ã€‚

å¦‚æœæ‚¨æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨åœ†å½¢æ˜¾ç¤ºå±ï¼Œæ‚¨å¯èƒ½éœ€è¦é˜…è¯»æˆ‘ä»¬ä¹‹å‰ä¸ºå…¶ç¼–å†™çš„å‡†å¤‡å†…å®¹ï¼Œå¹¶æ ¹æ®æ­¤å†…å®¹é…ç½®åº“ç¯å¢ƒï¼Œä»¥ç¡®ä¿æ‚¨èƒ½å¤Ÿé¡ºåˆ©ä½¿ç”¨åœ†å½¢æ˜¾ç¤ºå±ã€‚

- **[ä½¿ç”¨Seeed Studio XIAOåœ†å½¢æ˜¾ç¤ºå±çš„å‡†å¤‡å·¥ä½œ](https://wiki.seeedstudio.com/cn/get_start_round_display#getting-started)**

### å®‰è£…microSDå¡

åœ†å½¢æ˜¾ç¤ºå±æ”¯æŒä½¿ç”¨ä¸å¤§äº**32GB**çš„**FAT32**æ ¼å¼microSDå¡ã€‚å®‰è£…microSDå¡æ—¶ï¼ŒmicroSDå¡çš„é‡‘æ‰‹æŒ‡åº”æœå‘æ¿å­å†…ä¾§æ’å…¥ã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/64.jpg" style={{width:500, height:'auto'}}/></div>

### å®‰è£…RTCç”µæ± 

åœ†å½¢æ˜¾ç¤ºå±æ”¯æŒRTCåŠŸèƒ½ï¼Œå†…ç½®PCF8563TèŠ¯ç‰‡ã€‚å¦‚æœæ‚¨éœ€è¦ä½¿ç”¨RTCåŠŸèƒ½ï¼Œå¯èƒ½éœ€è¦ä¸€ä¸ªçº½æ‰£ç”µæ± æ¥ä¿æŒRTCå·¥ä½œã€‚

æˆ‘ä»¬æ¨èä½¿ç”¨CR927ç³»åˆ—çº½æ‰£ç”µæ± ï¼Œå®‰è£…æ—¶æ­£æï¼ˆå¹³é¢ï¼‰æœå¤–ï¼Œè´Ÿæï¼ˆç•¥å¾®çªå‡ºçš„è¡¨é¢ï¼‰æœå†…ã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/65.jpg" style={{width:500, height:'auto'}}/></div>

:::note
ä¸Šå›¾ä»…æ˜¾ç¤ºç”µæ± å®‰è£…æ–¹å‘ï¼Œå¹¶éå®Œå…¨å®‰è£…çš„ç”µæ± ã€‚æ­£ç¡®å®‰è£…çš„ç”µæ± åº”å®Œå…¨æ’å…¥ç”µæ± åº§ä¸­ã€‚
:::

### å®‰è£…ä¾›ç”µç”µæ± 

åœ†å½¢æ˜¾ç¤ºå±æ”¯æŒå¤–æ¥3.7Vé”‚ç”µæ± ã€‚å†…ç½®ç”µæºç®¡ç†èŠ¯ç‰‡ï¼Œå¯é€šè¿‡XIAOçš„USBç«¯å£ä¸ºç”µæ± å……ç”µã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/77.jpg" style={{width:500, height:'auto'}}/></div>

åœ†å½¢æ˜¾ç¤ºå±è¿˜æœ‰ä¸€ä¸ªå……ç”µæŒ‡ç¤ºç¯ã€‚å®ƒæœ‰ä¸‰ç§çŠ¶æ€ï¼š

1. æœªè¿æ¥é”‚ç”µæ± æ—¶ï¼ŒæŒ‡ç¤ºç¯ä½äº®åº¦å¸¸äº®ã€‚
2. è¿æ¥é”‚ç”µæ± å¹¶ä¸ºé”‚ç”µæ± å……ç”µæ—¶ï¼Œçº¢ç¯é«˜äº®åº¦å¸¸äº®ã€‚
3. è¿æ¥é”‚ç”µæ± ä¸”ç”µæ± å……æ»¡ç”µæ—¶ï¼ŒæŒ‡ç¤ºç¯ç†„ç­ã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/78.jpg" style={{width:500, height:'auto'}}/></div>


### åœ†å½¢æ˜¾ç¤ºå±å¼€å…³


åœ†å½¢æ˜¾ç¤ºå±ä¸Šè¿˜æœ‰ä¸€ä¸ªå¼€å…³ã€‚è¯¥å¼€å…³ç”¨äºæ§åˆ¶æ˜¾ç¤ºå±çš„å¼€/å…³ä»¥åŠå¯¹XIAOçš„ä¾›ç”µã€‚å½“æ‚¨å°†å¼€å…³æ‹¨åˆ°OFFæ—¶ï¼Œç”µæ± å°†ä¸ä¼šä¸ºXIAOä¾›ç”µï¼Œæ˜¾ç¤ºå±å°†å…³é—­ã€‚å½“æ‚¨å°†å¼€å…³æ‹¨åˆ°ONæ—¶ï¼Œæ˜¾ç¤ºå±å°†ç‚¹äº®ï¼Œç”µæ± å°†ä¸ºXIAOä¾›ç”µï¼ˆå‰ææ˜¯å®‰è£…äº†ä¾›ç”µç”µæ± ï¼‰ä»¥ç¡®ä¿ç¨‹åºè¿è¡Œã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/66.jpg" style={{width:500, height:'auto'}}/></div>

:::note
è¿™é‡Œæè¿°ä¸­çš„ä¸ºXIAOä¾›ç”µæ˜¯æŒ‡é€šè¿‡åœ†å½¢æ˜¾ç¤ºå±ä¸ºXIAOä¾›ç”µã€‚å¦‚æœæ‚¨ç›´æ¥ä¸ºXIAOä¾›ç”µï¼Œé‚£ä¹ˆåœ†å½¢æ˜¾ç¤ºå±ä¸Šçš„å¼€å…³æ— æ³•æ–­å¼€å¯¹XIAOçš„ä¾›ç”µã€‚å¦‚æœæ‚¨æƒ³é€šè¿‡åœ†å½¢æ˜¾ç¤ºå±ä¸Šçš„å¼€å…³æ§åˆ¶æ•´ä¸ªè®¾å¤‡ï¼Œéœ€è¦åœ¨åœ†å½¢æ˜¾ç¤ºå±ä¸Šå®‰è£…ä¾›ç”µç”µæ± ã€‚

è¿˜è¦æ³¨æ„ï¼ŒæŸäº›XIAOï¼ˆå¦‚XIAO ESP32C3ï¼‰åœ¨æ–­ç”µåé‡æ–°ä¸Šç”µè¿è¡Œç¨‹åºæ—¶ï¼Œå¯èƒ½éœ€è¦æŒ‰ä¸‹XIAOä¸Šçš„å¤ä½æŒ‰é’®æ‰èƒ½å¼€å§‹å·¥ä½œã€‚
:::

### åœ†å½¢æ˜¾ç¤ºå±ç”µè·¯è®¾è®¡

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æˆªå–åœ†å½¢æ˜¾ç¤ºå±ç¡¬ä»¶çš„ç”µè·¯åŸç†å›¾ï¼Œå¹¶å‘ŠçŸ¥ç”¨æˆ·XIAOä¸Šçš„å“ªäº›IOå¼•è„šåœ¨åœ†å½¢æ˜¾ç¤ºå±ç¡¬ä»¶ä¸­è¢«ä½¿ç”¨ï¼Œä»¥é¿å…åœ¨ä½¿ç”¨IOæ—¶å‘ç”Ÿå†²çªã€‚

#### æµ‹é‡ç”µæ± ç”µå‹å¼•è„š

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/70.png" style={{width:400, height:'auto'}}/></div>

åœ¨åœ†å½¢æ˜¾ç¤ºå±çš„è®¾è®¡ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨XIAOä¸Šçš„**A0/D0**å¼•è„šè¿æ¥åˆ°æ¿è½½ç”µæ± çš„ç”µè·¯ã€‚å¯ä»¥é€šè¿‡è¯»å–æ­¤å¼•è„šçš„æ¨¡æ‹Ÿå€¼æ¥è·å–å‰©ä½™ç”µæ± ç”µé‡ã€‚

#### SDå¡ç”µè·¯å¼•è„š

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/67.png" style={{width:800, height:'auto'}}/></div>

SDå¡éƒ¨åˆ†ä½¿ç”¨XIAOä¸Šçš„å››ä¸ªIOç«¯å£ï¼Œä½¿ç”¨æƒ…å†µå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚

<div class="table-center">
    <table align="center">
        <tr>
            <th align="center">XIAO GPIO</th>
            <th align="center">microSDå¡æ§½</th>
        </tr>
        <tr>
            <td align="center">D2</td>
            <td align="center">CS</td>
        </tr>
        <tr>
            <td align="center">D8</td>
            <td align="center">SCK</td>
        </tr>
        <tr>
            <td align="center">D9</td>
            <td align="center">MISO</td>
        </tr>
        <tr>
            <td align="center">D10</td>
            <td align="center">MOSI</td>
        </tr>
    </table>
</div>

#### RTC ç”µè·¯å¼•è„š

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/68.png" style={{width:500, height:'auto'}}/></div>

RTC åŠŸèƒ½ä½¿ç”¨ IIC åè®®ï¼Œå› æ­¤å ç”¨ **D5 (SCL)** å’Œ **D4 (SDA)** å¼•è„šã€‚

#### è§¦æ‘¸å±ç”µè·¯å¼•è„š

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/69.png" style={{width:400, height:'auto'}}/></div>

è§¦æ‘¸å±éƒ¨åˆ†ä½¿ç”¨ XIAO ä¸Šçš„å››ä¸ª IO ç«¯å£ï¼Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚

<div class="table-center">
    <table align="center">
        <tr>
            <th align="center">XIAO GPIO</th>
            <th align="center">è§¦æ‘¸å±</th>
        </tr>
        <tr>
            <td align="center">D4 (SDA)</td>
            <td align="center">è§¦æ‘¸å± IIC</td>
        </tr>
        <tr>
            <td align="center">D5 (SCL)</td>
            <td align="center">è§¦æ‘¸å± IIC</td>
        </tr>
        <tr>
            <td align="center">D3</td>
            <td align="center">LCD_DC</td>
        </tr>
        <tr>
            <td align="center">D1</td>
            <td align="center">LCD_CS</td>
        </tr>
        <tr>
            <td align="center">D7</td>
            <td align="center">TP_INT</td>
        </tr>
        <tr>
            <td align="center">D6</td>
            <td align="center">å±å¹•èƒŒå…‰</td>
        </tr>
    </table>
</div>


## Round Display åº“æ¦‚è¿°

Round Display çš„ç»å¤§éƒ¨åˆ†è½¯ä»¶å¼€å‘éƒ½åŸºäº XIAO è‡ªèº«çš„ç¡¬ä»¶æ”¯æŒã€‚å›¾å½¢åŸºäº TFT åº“ã€LVGL åº“å’Œ Arduino GFX åº“ã€‚

ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ Round Display ä¸Šçš„åŠŸèƒ½ï¼Œæˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ªå•ç‹¬çš„åº“ï¼Œä¸»è¦è°ƒç”¨ä¸Šè¿°åº“çš„æ¥å£ï¼Œä»¥é™ä½ç”¨æˆ·åœ¨åæœŸé˜¶æ®µè¿›è¡Œç‹¬ç«‹å¼€å‘æ—¶çš„é—¨æ§›ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹ä»‹ç»æˆ‘ä¸º Round Display å‡†å¤‡çš„è¿™äº›åº“æœ‰å“ªäº›åŠŸèƒ½ä»¥åŠå¦‚ä½•åˆ†åˆ«ä½¿ç”¨å®ƒä»¬ã€‚

<div class="github_container" style={{textAlign: 'center'}}>
    <a class="github_item" href="https://github.com/Seeed-Studio/Seeed_Arduino_RoundDisplay" target="_blank" rel="noopener noreferrer">
    <strong><span><font color={'FFFFFF'} size={"4"}> ä¸‹è½½åº“æ–‡ä»¶</font></span></strong> <svg aria-hidden="true" focusable="false" role="img" className="mr-2" viewBox="-3 10 9 1" width={16} height={16} fill="currentColor" style={{textAlign: 'center', display: 'inline-block', userSelect: 'none', verticalAlign: 'text-bottom', overflow: 'visible'}}><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z" /></svg>
    </a>
</div>

<br></br>

### lv_xiao_round_screen.h

`lv_xiao_round_screen.h` æ–‡ä»¶æ˜¯ Round Display åº“ä¸­çš„å¤´æ–‡ä»¶ï¼Œç”¨äºé©±åŠ¨å±å¹•çš„æ˜¾ç¤ºå’Œè§¦æ‘¸åŠŸèƒ½ã€‚

æ–‡ä»¶å¼€å¤´è¿›è¡Œäº†å®å®šä¹‰æ£€æŸ¥ï¼Œæ—¨åœ¨è¦æ±‚ä½¿ç”¨ Round Display çš„å¼€å‘è€…åœ¨ç»˜åˆ¶å±å¹•å›¾æ¡ˆæ—¶éœ€è¦é€‰æ‹©æ‚¨æƒ³è¦å¼€å‘çš„å›¾å½¢åº“ã€‚æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼š**TFT** å’Œ **Arduino GFX**ã€‚å¦‚æœæ‚¨é€‰æ‹© **TFT** åº“ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯å¯ä»¥æ”¯æŒ **LVGL** çš„åº“ã€‚

```cpp
#if defined(USE_TFT_ESPI_LIBRARY) && defined(USE_ARDUINO_GFX_LIBRARY)
#error "More than one graphics library is defined."
#elif defined(USE_TFT_ESPI_LIBRARY)
#include <TFT_eSPI.h>
TFT_eSPI tft = TFT_eSPI(SCREEN_WIDTH, SCREEN_HEIGHT);
#elif defined(USE_ARDUINO_GFX_LIBRARY)
#include <Arduino_GFX_Library.h>
```

è¿™ç§è®¾è®¡çš„åŸå› æ˜¯æŸäº› XIAO åœ¨ä¸åŒå›¾å½¢åº“ä¸Šç»˜åˆ¶å›¾æ¡ˆæ—¶å…·æœ‰å„è‡ªçš„ä¼˜åŠ¿ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ XIAO nRF52840ï¼Œé‚£ä¹ˆä½¿ç”¨ Arduino GFX åº“å¯èƒ½ä¼šæ›´èŠ‚çœå†…å­˜ä¸”æ›´ç¨³å®šã€‚å¯¹äº XIAO ESP32S3ï¼Œè¿™æ¬¾å¤§å†…å­˜çš„ XIAO åœ¨å¤„ç† LVGL ç­‰å›¾å½¢åº“æ–¹é¢å…·æœ‰å¤©ç„¶ä¼˜åŠ¿ï¼Œä¹Ÿèƒ½å¤Ÿç»˜åˆ¶æ›´å¤æ‚çš„å›¾æ¡ˆå’Œ UIã€‚

å› æ­¤ï¼Œå¦‚æœæ‚¨éœ€è¦ä½¿ç”¨ Round Display ç»˜åˆ¶å›¾æ¡ˆï¼Œè¯·ä¸è¦å¿˜è®°é€‰æ‹©æ‚¨æƒ³è¦ä½¿ç”¨çš„å›¾å½¢åº“ï¼Œå¹¶åœ¨ Arduino ç¨‹åºçš„å¼€å¤´å®šä¹‰å®ƒã€‚

- å¦‚æœæ‚¨æƒ³ä½¿ç”¨ TFT åº“æˆ– LVGL åº“ï¼š

```cpp
#define USE_TFT_ESPI_LIBRARY
```

- å¦‚æœä½ æƒ³ä½¿ç”¨ Arduino GFX åº“ï¼š

```cpp
#define USE_ARDUINO_GFX_LIBRARY
```

1. `void xiao_disp_init(void)`: æ­¤å‡½æ•°ç”¨äºåˆå§‹åŒ–æ˜¾ç¤ºå±èƒŒå…‰å¹¶å°†æ˜¾ç¤ºå±æ—‹è½¬åˆ°åˆå§‹ä½ç½®ï¼Œè®¾å¤‡æ˜¾ç¤ºå±èƒŒæ¿é¢œè‰²ä¸ºçº¯é»‘è‰²ã€‚æ­¤å‡½æ•°é€šå¸¸ä¸å•ç‹¬ä½¿ç”¨ï¼Œéœ€è¦åˆå§‹åŒ–æ—¶ä½¿ç”¨ `lv_xiao_disp_init()` å‡½æ•°ã€‚

2. `void lv_xiao_disp_init(void)`: åˆå§‹åŒ–èƒŒå…‰ï¼Œå¹¶åˆå§‹åŒ–æ˜¾ç¤ºé©±åŠ¨ç¨‹åºã€‚é€šå¸¸ç”¨äºæ˜¾ç¤ºå±åˆå§‹åŒ–ã€‚

3. `bool chsc6x_is_pressed(void)`: æ­¤å‡½æ•°ç”¨äºæ£€æŸ¥å±å¹•æ˜¯å¦è¢«è§¦æ‘¸ï¼Œå¦‚æœå±å¹•è¢«è§¦æ‘¸åˆ™è¿”å› `Ture`ã€‚

4. `void lv_xiao_touch_init(void)`: æ­¤å‡½æ•°ç”¨äºåˆå§‹åŒ–è§¦æ‘¸å±åŠå…¶é©±åŠ¨ç¨‹åºã€‚

5. `void chsc6x_read( lv_indev_drv_t * indev_driver, lv_indev_data_t * data )`: æ­¤å‡½æ•°ç”¨äºè·å–è§¦æ‘¸å±çš„åæ ‡ç‚¹ã€‚


### lv_hardware_test.h

`lv_hardware_test.h` æ–‡ä»¶æ˜¯ Round Display åº“ä¸­ç¤ºä¾‹ **HardwareTest** çš„å¤´æ–‡ä»¶ã€‚æ­¤å¤´æ–‡ä»¶ä¸º Round Display å‡†å¤‡äº†å¤§éƒ¨åˆ†ç¡¬ä»¶ä½¿ç”¨åŠŸèƒ½ã€‚

å¦‚æœæ‚¨æƒ³ä½¿ç”¨æ­¤å¤´æ–‡ä»¶ä¸­çš„åŠŸèƒ½ï¼Œå¯ä»¥ç›´æ¥å°†è¯¥æ–‡ä»¶å¤åˆ¶åˆ°æ‚¨çš„ Arduino æ–‡ä»¶çš„åŒä¸€æ–‡ä»¶ç›®å½•ä¸­ã€‚

1. `int32_t battery_level_percent(void)`: é€šè¿‡è°ƒç”¨æ­¤å‡½æ•°ï¼Œæ‚¨å¯ä»¥è¯»å–å¹¶è®¡ç®—ç”µæ± ç”µé‡ç™¾åˆ†æ¯”ï¼Œä»¥åœ¨åº”ç”¨ç¨‹åºä¸­æ˜¾ç¤ºç”µæ± ç”µé‡ã€‚

2. `void lv_hardware_test(void)`: æ­¤å‡½æ•°ç”¨äºæµ‹è¯•æ‰€æœ‰ç¡¬ä»¶åŠŸèƒ½ï¼ŒåŒ…æ‹¬å±å¹•æ˜¾ç¤ºã€å±å¹•è§¦æ‘¸ã€RTC æ—¶é’Ÿå’Œç”µæ± ç”µé‡ã€‚æ‚¨å¯ä»¥å‚è€ƒæ­¤å‡½æ•°çš„ç¼–å†™æ–¹æ³•æ¥å®Œæˆæ‚¨æƒ³è¦çš„ Round Display åŠŸèƒ½å¼€å‘ã€‚

## KE æŒ‰é’® & GPIO

åœ¨æ–°ç‰ˆæœ¬çš„ Round Display ä¸Šï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ª KE å¼€å…³æ¥é€‰æ‹©æ€§åœ°é‡Šæ”¾æŸäº› GPIOï¼Œä¾›ç”¨æˆ·é€‰æ‹©æ€§ä½¿ç”¨ã€‚

KE å¼€å…³è®¾è®¡åœ¨ microSD å¡æ§½å’Œè¿æ¥åˆ° XIAO çš„å¼•è„šæ’çš„ä¸­é—´ã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/90.jpg" style={{width:400, height:'auto'}}/></div>

æ­¤å¼€å…³çš„ç”µè·¯è®¾è®¡å¦‚ä¸‹æ‰€ç¤ºã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/91.png" style={{width:400, height:'auto'}}/></div>

è¿™æ„å‘³ç€å½“å¼€å…³é—­åˆæ—¶ **ï¼ˆåˆ‡æ¢åˆ° ON ä¾§ï¼‰**ï¼ŒRound Display çš„ç”µæ± ç”µå‹è¯»å–åŠŸèƒ½å’Œæ˜¾ç¤ºå±èƒŒå…‰åŠŸèƒ½å˜ä¸ºå¯ç”¨ã€‚

å½“å¼€å…³æ–­å¼€æ—¶ **ï¼ˆåˆ‡æ¢åˆ°æ•°å­—ä¾§ï¼‰**ï¼ŒXIAO ä¸Šçš„å¼•è„š A0 å’Œ D6 å¤„äºå¯ç”¨çŠ¶æ€ã€‚


## æµ‹é‡ç”µæ± ç”µå‹

ç”±äº XIAO ä¸Šç¼ºå°‘ IO å¼•è„šï¼Œå¤§å¤šæ•° XIAO æ— æ³•æµ‹é‡ç”µæ± ç”µå‹ï¼Œå°½ç®¡åœ¨æŸäº› XIAO ä¸Šé…ç½®äº†ç”µæºç®¡ç†èŠ¯ç‰‡ä»¥å…è®¸å¤–éƒ¨ç”µæ± ã€‚

ä½†å¦‚æœæ‚¨é€‰æ‹©ä½¿ç”¨ Round Display å¹¶é€šè¿‡å±å¹•ä¸º XIAO ä¾›ç”µï¼Œé‚£ä¹ˆæµ‹é‡ç”µæ± ç”µå‹å°†æˆä¸ºç°å®ã€‚

ä»¥ä¸‹æ˜¯æµ‹é‡ç”µæ± ç”µå‹çš„ç¤ºä¾‹ç¨‹åºã€‚å‡½æ•° `battery_level_percent()` é€‰è‡ª `lv_hardware_test.h` æ–‡ä»¶ã€‚

```cpp
#define NUM_ADC_SAMPLE 20           // é‡‡æ ·é¢‘ç‡
#define RP2040_VREF 3300            // å½“æ‚¨ä½¿ç”¨ XIAO RP2040 æ—¶ï¼Œæ‚¨éœ€è¦æµ‹é‡ 3.3V å¼•è„šçš„å®é™…ç”µå‹å¹¶ä¿®æ”¹è¯¥å€¼ã€‚ï¼ˆå•ä½ï¼šmVï¼‰
#define BATTERY_DEFICIT_VOL 1850    // ç”µæ± ç”µé‡è€—å°½æ—¶çš„ç”µå‹å€¼
#define BATTERY_FULL_VOL 2450       // ç”µæ± æ»¡ç”µæ—¶çš„ç”µå‹å€¼

int32_t battery_level_percent(void)
{
  int32_t mvolts = 0;
#if defined(CONFIG_IDF_TARGET_ESP32S3) || defined(CONFIG_IDF_TARGET_ESP32C3)
  for(int8_t i=0; i<NUM_ADC_SAMPLE; i++){
    mvolts += analogReadMilliVolts(D0);
  }
  mvolts /= NUM_ADC_SAMPLE;
#elif defined(ARDUINO_SEEED_XIAO_NRF52840_SENSE) || defined(ARDUINO_SEEED_XIAO_NRF52840)
  analogReference(AR_INTERNAL2V4);  // 0.6V ref  1/4 Gain
  int32_t adc_raw = 0;
  for(int8_t i=0; i<NUM_ADC_SAMPLE; i++){
    adc_raw += analogRead(D0);
  }
  adc_raw /= NUM_ADC_SAMPLE;
  mvolts = 2400 * adc_raw / (1<<12);
#elif defined(ARDUINO_SEEED_XIAO_RP2040)
  int32_t adc_raw = 0;
  for(int8_t i=0; i<NUM_ADC_SAMPLE; i++){
    adc_raw += analogRead(D0);
  }
  adc_raw /= NUM_ADC_SAMPLE;
  mvolts = RP2040_VREF * adc_raw / (1<<12);
#endif
  int32_t level = (mvolts - BATTERY_DEFICIT_VOL) * 100 / (BATTERY_FULL_VOL-BATTERY_DEFICIT_VOL); // 1850 ~ 2100
  level = (level<0) ? 0 : ((level>100) ? 100 : level); 
  return level;
}

void setup() {
  // åœ¨è¿™é‡Œæ”¾ç½®æ‚¨çš„è®¾ç½®ä»£ç ï¼Œåªè¿è¡Œä¸€æ¬¡ï¼š
  Serial.begin(115200);
  while(!Serial);

  analogReadResolution(12);
}

void loop() {
  // åœ¨è¿™é‡Œæ”¾ç½®æ‚¨çš„ä¸»ä»£ç ï¼Œé‡å¤è¿è¡Œï¼š
  int32_t batteryVal = battery_level_percent();
  Serial.print("å‰©ä½™ç”µé‡ç™¾åˆ†æ¯”ä¸ºï¼š");
  Serial.print(batteryVal);
  Serial.print(" %");
  Serial.println();
  delay(1000);
}
```

:::tip
æ­¤ç¨‹åºä¸æ˜¯é€šç”¨ç¨‹åºï¼Œæµ‹é‡çš„ç”µæ± ç™¾åˆ†æ¯”å¯èƒ½ä¸å‡†ç¡®ã€‚è¿™æ˜¯å› ä¸ºæ¯ä¸ªäººä½¿ç”¨çš„ç”µæ± ã€èŠ¯ç‰‡å’Œå¼€å‘æ¿éƒ½ä¸åŒï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œæ­¤ç¨‹åºæ—¶ï¼Œæ‚¨å¯èƒ½éœ€è¦æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ç¨‹åºã€‚ä¿®æ”¹æ–¹æ³•è¯·å‚è€ƒæœ¬èŠ‚çš„[ç¨‹åºæ³¨é‡Š](#program-annotation)éƒ¨åˆ†ã€‚
:::


é€‰æ‹©æ‚¨æ­£åœ¨ä½¿ç”¨çš„ XIAO å¼€å‘æ¿ï¼Œä¸Šä¼ ç¨‹åºï¼Œæ‰“å¼€ä¸²å£ç›‘è§†å™¨ï¼Œå¹¶å°†æ³¢ç‰¹ç‡è®¾ç½®ä¸º **115200**ã€‚å¦‚æœæ‚¨å·²è¿æ¥ç”µæ± å¹¶é€šç”µï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿåœ¨ä¸²å£ç›‘è§†å™¨ä¸­çœ‹åˆ°ç”µæ± ç”µå‹ã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/80.png" style={{width:700, height:'auto'}}/></div>

### ç¨‹åºæ³¨é‡Š

æ­¤ä»£ç ä½¿ç”¨ ADC æµ‹é‡ç”µæ± ç”µå‹å¹¶è®¡ç®—ç”µæ± ç”µé‡ç™¾åˆ†æ¯”ã€‚å®ç°æ–¹å¼å› ç¡¬ä»¶å¹³å°è€Œå¼‚ï¼š

- å¯¹äº ESP32-S3 å’Œ ESP32-C3 å¹³å°ï¼Œä½¿ç”¨ `analogReadMilliVolts` å‡½æ•°è¯»å–æ¨¡æ‹Ÿç”µå‹å€¼ï¼Œç„¶åå–å¤šä¸ªé‡‡æ ·çš„å¹³å‡å€¼æ¥è·å¾—å¹³å‡ç”µæ± ç”µå‹ã€‚
- å¯¹äº Seeeduino XIAO NRF52840 å¹³å°ï¼Œé¦–å…ˆä½¿ç”¨ `analogReference` å‡½æ•°å°†å‚è€ƒç”µå‹æŒ‡å®šä¸º 2.4Vï¼Œç„¶åä½¿ç”¨ analogRead å‡½æ•°è¯»å–æ¨¡æ‹Ÿç”µå‹å€¼ï¼Œå¹¶è®¡ç®—å¹³å‡ç”µæ± ç”µå‹ã€‚
- å¯¹äº Seeeduino XIAO RP2040 å¹³å°ï¼Œä½¿ç”¨ `analogRead` å‡½æ•°è¯»å–æ¨¡æ‹Ÿç”µå‹å€¼ï¼Œå¹¶è®¡ç®—å¹³å‡ç”µæ± ç”µå‹ã€‚

åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œéƒ½ä¼šè®¡ç®—å¹³å‡ç”µæ± ç”µå‹ï¼Œç„¶åä½¿ç”¨å…¬å¼ `(mvolts - BATTERY_DEFICIT_VOL) * 100 / (BATTERY_FULL_VOL - BATTERY_DEFICIT_VOL)` è®¡ç®—ç”µæ± ç”µé‡ç™¾åˆ†æ¯”ï¼Œå…¶ä¸­ mvolts æ˜¯å¹³å‡ç”µæ± ç”µå‹ï¼Œ`BATTERY_DEFICIT_VOL` æ˜¯ç”µæ± çš„æœ€ä½å·¥ä½œç”µå‹ï¼Œ`BATTERY_FULL_VOL` æ˜¯ç”µæ± çš„æœ€å¤§ç”µå‹ã€‚æœ€åï¼Œä»£ç é™åˆ¶ç”µæ± ç”µé‡ç™¾åˆ†æ¯”ä»¥ç¡®ä¿å…¶åœ¨ 0 åˆ° 100 ä¹‹é—´ã€‚

æ€»ä¹‹ï¼Œä½¿ç”¨æ­¤ç¨‹åºæ—¶ï¼Œä»¥ä¸‹å‚æ•°å†³å®šäº†ç”µå‹æµ‹é‡çš„å‡†ç¡®æ€§ã€‚

```c
#define RP2040_VREF 3300            // å½“æ‚¨ä½¿ç”¨ XIAO RP2040 æ—¶ï¼Œæ‚¨éœ€è¦æµ‹é‡ 3.3V å¼•è„šçš„å®é™…ç”µå‹å¹¶ä¿®æ”¹è¯¥å€¼ã€‚ï¼ˆå•ä½ï¼šmVï¼‰
#define BATTERY_DEFICIT_VOL 1850    // ç”µæ± ç”µé‡è€—å°½æ—¶çš„ç”µå‹å€¼
#define BATTERY_FULL_VOL 2450       // ç”µæ± æ»¡ç”µæ—¶çš„ç”µå‹å€¼
```

æ‚¨éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯è·å–æ‚¨è´­ä¹°çš„ç”µæ± åœ¨ç”µé‡ä¸è¶³/æ»¡ç”µçŠ¶æ€ä¸‹çš„æ¨¡æ‹Ÿå€¼ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨æ­¤å‡½æ•°è·å–ç”µæ± çš„æ¨¡æ‹Ÿå€¼ã€‚æ‚¨éœ€è¦åœ¨ç”µæ± æ»¡ç”µå’Œç”µé‡ä¸è¶³çŠ¶æ€ä¸‹å„è·å–ä¸€æ¬¡æ•°å€¼ã€‚

```cpp
int32_t battery_test(void)
{
  int32_t mvolts = 0;
#if defined(CONFIG_IDF_TARGET_ESP32S3) || defined(CONFIG_IDF_TARGET_ESP32C3)
  for(int8_t i=0; i<NUM_ADC_SAMPLE; i++){
    mvolts += analogReadMilliVolts(D0);
  }
  mvolts /= NUM_ADC_SAMPLE;
#elif defined(ARDUINO_SEEED_XIAO_NRF52840_SENSE) || defined(ARDUINO_SEEED_XIAO_NRF52840)
  analogReference(AR_INTERNAL2V4);  // 0.6V ref  1/4 Gain
  int32_t adc_raw = 0;
  for(int8_t i=0; i<NUM_ADC_SAMPLE; i++){
    adc_raw += analogRead(D0);
  }
  adc_raw /= NUM_ADC_SAMPLE;
  mvolts = 2400 * adc_raw / (1<<12);
#elif defined(ARDUINO_SEEED_XIAO_RP2040)
  int32_t adc_raw = 0;
  for(int8_t i=0; i<NUM_ADC_SAMPLE; i++){
    adc_raw += analogRead(D0);
  }
  adc_raw /= NUM_ADC_SAMPLE;
  mvolts = RP2040_VREF * adc_raw / (1<<12);
#endif
  return mvolts;
}
```

:::tip
`battery_test()` å‡½æ•°å®é™…ä¸Šæ˜¯ `battery_level_percent()` å‡½æ•°ï¼Œåªæ˜¯ç§»é™¤äº†æœ€åä¸¤è¡Œè®¡ç®—ç™¾åˆ†æ¯”çš„ä»£ç ã€‚
:::

ç„¶ååªéœ€ä¿®æ”¹ç¨‹åºä¸­å¯¹åº”çš„å€¼ä¸ºä½ æµ‹é‡çš„å€¼ã€‚

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ **XIAO RP2040**ï¼Œé‚£ä¹ˆä½ éœ€è¦é¢å¤–æ‰§è¡Œä¸€ä¸ªæ­¥éª¤ï¼Œå³ä½¿ç”¨ä¸‡ç”¨è¡¨æµ‹é‡ XIAO RP2040 çš„ 3.3V å¼•è„šä¸Šçš„å®é™…ç”µå‹ã€‚å°†æµ‹é‡çš„ç”µå‹å€¼è½¬æ¢ä¸º **mV** å•ä½ï¼Œå¹¶ä¿®æ”¹ç›¸åº”çš„ç¨‹åºã€‚

ä¾‹å¦‚ï¼Œä»¥ä¸‹æ˜¯æˆ‘ä½¿ç”¨ XIAO RP2040 å’Œç”µæ± è¿›è¡Œå®é™…æµ‹é‡çš„ç»“æœã€‚

```c
#define RP2040_VREF 3080
#define BATTERY_DEFICIT_VOL 1541
#define BATTERY_FULL_VOL 1791
```

## RTC åŠŸèƒ½

RTC åŠŸèƒ½éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å››ä¸ªéƒ¨åˆ†æ¥ä»‹ç»å…¶åº”ç”¨ã€‚
1. é¦–å…ˆæ˜¯é’ˆå¯¹æ²¡æœ‰ç½‘ç»œåŠŸèƒ½çš„ XIAOï¼Œæ‚¨å¯ä»¥é€šè¿‡æ‰‹åŠ¨è®¾ç½®åˆå§‹æ—¶é—´æ¥æ ¡æ­£ RTCã€‚
2. ç„¶åé€šè¿‡çº½æ‰£ç”µæ± ä¸º RTC ä¾›ç”µï¼Œä»¥æŒç»­è·å¾—å‡†ç¡®çš„æ—¶é—´ã€‚
3. å¯¹äºå…·æœ‰ç½‘ç»œåŠŸèƒ½çš„ XIAOï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç½‘ç»œåŠŸèƒ½æ¥æ ¡æ­£æ—¶é—´ã€‚
4. ç»“åˆ RTC åŠŸèƒ½ç»˜åˆ¶ä¸€ä¸ªç®€å•çš„æ—¶é’Ÿè¡¨ç›˜ã€‚

### ç¦»çº¿æ‰‹åŠ¨æ ¡å‡† RTC

ä»¥ä¸‹æ˜¯æ‰‹åŠ¨æ ¡å‡† RTC æ—¶é—´çš„ç¤ºä¾‹ç¨‹åºã€‚è®¾ç½®æ”¾åœ¨ `Setup()` å‡½æ•°ä¸­ï¼Œä»¥ç¡®ä¿è®¾ç½®ç¨‹åºåªæ‰§è¡Œä¸€æ¬¡ã€‚æ­¤ç¨‹åºæ˜¯ä¸ºæ²¡æœ‰ç½‘ç»œåŠŸèƒ½çš„ XIAO è®¾ç½®åˆå§‹ RTC æ—¶é—´çš„æœ€æœ‰æ•ˆæ–¹æ³•ã€‚

```cpp
#include "I2C_BM8563.h"

I2C_BM8563 rtc(I2C_BM8563_DEFAULT_ADDRESS, Wire);

void setup() {
  // Init Serial
  Serial.begin(115200);
  while(!Serial);
  delay(50);

  // Init I2C
  Wire.begin();

  // Init RTC
  rtc.begin();

  // Set RTC Date
  I2C_BM8563_DateTypeDef dateStruct;
  dateStruct.weekDay = 3;
  dateStruct.month = 4;
  dateStruct.date = 26;
  dateStruct.year = 2023;
  rtc.setDate(&dateStruct);

  // Set RTC Time
  I2C_BM8563_TimeTypeDef timeStruct;
  timeStruct.hours   = 9;
  timeStruct.minutes = 43;
  timeStruct.seconds = 10;
  rtc.setTime(&timeStruct);

  Serial.println("RTC time calibration complete!");
}

void loop() {

}
```

ä¸Šä¼ ç¨‹åºå¹¶æ‰“å¼€ä¸²å£ç›‘è§†å™¨åï¼ŒRTC æ—¶é—´å°†å¼€å§‹æ ¡å‡†ã€‚å½“å‡ºç° **RTC time calibration complete!** æ—¶ï¼Œæ ¡å‡†å®Œæˆã€‚

### è·å– RTC æ—¶é—´

ä»¥ä¸‹ç¨‹åºæ¯ç§’è·å–ä¸€æ¬¡ RTC çš„æ—¶é—´å¹¶åœ¨ä¸²å£ç›‘è§†å™¨ä¸­æ‰“å°å‡ºæ¥ã€‚

:::tip
è·å– RTC æ—¶é—´çš„ç¨‹åºå¯ä»¥åœ¨ä¸Šè¿°æ‰‹åŠ¨æ ¡å‡†ç¨‹åºä¹‹åä½¿ç”¨ã€‚æ—¶é—´æ ¡å‡†ç¨‹åºåªéœ€è¦æ‰§è¡Œä¸€æ¬¡ï¼ŒRTC æ—¶é’Ÿå°†èƒ½å¤Ÿåœ¨çº½æ‰£ç”µæ± çš„ä¾›ç”µä¸‹æŒç»­å·¥ä½œï¼Œä¹‹åæ‚¨åªéœ€è¦ä½¿ç”¨è·å–æ—¶é—´çš„ç¨‹åºæ¥è·å¾—å‡†ç¡®æ—¶é—´ã€‚

æˆ‘ä»¬ä¸å»ºè®®å°†æ ¡å‡†æ—¶é—´å’Œè·å–æ—¶é—´çš„ç¨‹åºä¸€èµ·ä½¿ç”¨ï¼Œè¿™æ ·å½“ XIAO ä¸Šç”µæ—¶ï¼Œä¸¤è€…éƒ½ä¼šæ ¹æ®æ‚¨é…ç½®çš„æ—¶é—´é‡ç½®ä¸€æ¬¡ï¼Œé‚£ä¹ˆæ‚¨å°†æ°¸è¿œæ— æ³•è·å¾—å‡†ç¡®çš„æ—¶é—´ã€‚
:::

```cpp
#include "I2C_BM8563.h"

I2C_BM8563 rtc(I2C_BM8563_DEFAULT_ADDRESS, Wire);

void setup() {
  // Init Serial
  Serial.begin(115200);
  delay(50);

  // Init I2C
  Wire.begin();

  // Init RTC
  rtc.begin();
}

void loop() {
  I2C_BM8563_DateTypeDef dateStruct;
  I2C_BM8563_TimeTypeDef timeStruct;

  // Get RTC
  rtc.getDate(&dateStruct);
  rtc.getTime(&timeStruct);

  // Print RTC
#if defined(CONFIG_IDF_TARGET_ESP32S3) || defined(CONFIG_IDF_TARGET_ESP32C3)
  Serial.printf("%04d/%02d/%02d %02d:%02d:%02d\n",
              dateStruct.year,
              dateStruct.month,
              dateStruct.date,
              timeStruct.hours,
              timeStruct.minutes,
              timeStruct.seconds
              );
#else
  Serial.print(dateStruct.year);
  Serial.print(", ");
  Serial.print(dateStruct.month);
  Serial.print(", ");
  Serial.print(dateStruct.date);
  Serial.print(", ");
  Serial.print(timeStruct.hours);
  Serial.print(", ");
  Serial.print(timeStruct.minutes);
  Serial.print(", ");
  Serial.print(timeStruct.seconds);
  Serial.println();
#endif

  // Wait
  delay(1000);
}
```

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/71.png" style={{width:700, height:'auto'}}/></div>


### ç½‘ç»œæ ¡å‡† RTC æ—¶é—´

å¯¹äºå…·æœ‰ç½‘ç»œåŠŸèƒ½çš„ XIAOï¼Œäº‹æƒ…ä¼¼ä¹å˜å¾—å®¹æ˜“å¾—å¤šã€‚æœ‰äº†ç½‘ç»œï¼Œæ‚¨ç”šè‡³ä¸éœ€è¦ä½¿ç”¨çº½æ‰£ç”µæ± æ¥ä¿æŒ RTC å¼€ç®±å³ç”¨ï¼Œæ‚¨åªéœ€è¦åœ¨æ¯æ¬¡ä¸Šç”µæ—¶è¿›è¡Œç½‘ç»œæˆæ—¶å³å¯ã€‚

ä»¥ä¸‹æ˜¯ç½‘ç»œæˆæ—¶å¹¶åœ¨ä¸²å£ç›‘è§†å™¨ä¸Šè¾“å‡º RTC æ—¶é—´è¯»æ•°çš„ç¤ºä¾‹ç¨‹åºã€‚

:::caution
æ­¤ç¨‹åºä»…é€‚ç”¨äº XIAO ESP32 ç³»åˆ—ã€‚å› ä¸ºåªæœ‰è¿™ä¸ªç³»åˆ—å…·æœ‰ç½‘ç»œåŠŸèƒ½ã€‚
:::

```cpp
#include "I2C_BM8563.h"
#include <WiFi.h>

I2C_BM8563 rtc(I2C_BM8563_DEFAULT_ADDRESS, Wire);

const char* ntpServer = "time.cloudflare.com";
const char *ssid     = "YOUR_SSID";
const char *password = "YOUR_PASSWORD";

void setup() {
  // åˆå§‹åŒ–ä¸²å£
  Serial.begin(115200);
  delay(50);

  // è¿æ¥åˆ°æ¥å…¥ç‚¹
  WiFi.begin(ssid, password);
  Serial.print("æ­£åœ¨è¿æ¥åˆ° Wi-Fi ");
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  Serial.println(" å·²è¿æ¥");

  // è®¾ç½® ntp æ—¶é—´ä¸ºæœ¬åœ°æ—¶é—´
  configTime(9 * 3600, 0, ntpServer);

  // åˆå§‹åŒ– I2C
  Wire.begin();

  // åˆå§‹åŒ– RTC
  rtc.begin();

  // è·å–æœ¬åœ°æ—¶é—´
  struct tm timeInfo;
  if (getLocalTime(&timeInfo)) {
    // è®¾ç½® RTC æ—¶é—´
    I2C_BM8563_TimeTypeDef timeStruct;
    timeStruct.hours   = timeInfo.tm_hour;
    timeStruct.minutes = timeInfo.tm_min;
    timeStruct.seconds = timeInfo.tm_sec;
    rtc.setTime(&timeStruct);

    // è®¾ç½® RTC æ—¥æœŸ
    I2C_BM8563_DateTypeDef dateStruct;
    dateStruct.weekDay = timeInfo.tm_wday;
    dateStruct.month   = timeInfo.tm_mon + 1;
    dateStruct.date    = timeInfo.tm_mday;
    dateStruct.year    = timeInfo.tm_year + 1900;
    rtc.setDate(&dateStruct);
  }
}

void loop() {
  I2C_BM8563_DateTypeDef dateStruct;
  I2C_BM8563_TimeTypeDef timeStruct;

  // è·å– RTC
  rtc.getDate(&dateStruct);
  rtc.getTime(&timeStruct);

  // æ‰“å° RTC
#if defined(CONFIG_IDF_TARGET_ESP32S3) || defined(CONFIG_IDF_TARGET_ESP32C3)
    Serial.printf("%04d/%02d/%02d %02d:%02d:%02d\n",
                dateStruct.year,
                dateStruct.month,
                dateStruct.date,
                timeStruct.hours,
                timeStruct.minutes,
                timeStruct.seconds
               );
#else
     Serial.print(dateStruct.year);
     Serial.print(", ");
     Serial.print(dateStruct.month);
     Serial.print(", ");
     Serial.print(dateStruct.date);
     Serial.print(", ");
     Serial.print(timeStruct.hours);
     Serial.print(", ");
     Serial.print(timeStruct.minutes);
     Serial.print(", ");
     Serial.print(timeStruct.seconds);
     Serial.println();
#endif

  // ç­‰å¾…
  delay(1000);
}
```

å½“æ‚¨ä½¿ç”¨æ­¤ç¨‹åºæ—¶ï¼Œè¯·æ ¹æ®æ‚¨çš„å®é™…æƒ…å†µå¡«å†™ç½‘ç»œåç§°å’Œå¯†ç ã€‚ä¸Šä¼ ç¨‹åºåï¼Œæ‰“å¼€ä¸²å£ç›‘è§†å™¨å¹¶å°†æ³¢ç‰¹ç‡è®¾ç½®ä¸º115200ï¼Œç„¶åæ‚¨å°±å¯ä»¥çœ‹åˆ°å‡†ç¡®çš„æ—¶é—´ã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/72.png" style={{width:700, height:'auto'}}/></div>


### åŸºäºRTCæ—¶é—´çš„ç®€å•è¡¨ç›˜

ä»¥ä¸‹ç¨‹åºæ˜¯åŸºäºRTCæ—¶é’Ÿç»˜åˆ¶çš„è¡¨ç›˜ç¨‹åºã€‚

:::caution
ä»¥ä¸‹ç¨‹åºä»…å…¼å®¹é™¤XIAO nRF52840ä¹‹å¤–çš„XIAOã€‚XIAO nRF52840ç›®å‰åœ¨TFTå…¼å®¹æ€§æ–¹é¢å­˜åœ¨é—®é¢˜ã€‚ä½†æ‚¨å¯ä»¥è€ƒè™‘ä½¿ç”¨Arduino GFXåº“æˆ–LVGLæ¥ç»˜åˆ¶è¡¨ç›˜ã€‚
:::

```cpp
#include <Arduino.h>
#include <TFT_eSPI.h>
#include <SPI.h>
#include "I2C_BM8563.h"
#include <Wire.h>

#define USE_TFT_ESPI_LIBRARY

#include "lv_xiao_round_screen.h"

I2C_BM8563 rtc(I2C_BM8563_DEFAULT_ADDRESS, Wire);

#if defined(CONFIG_IDF_TARGET_ESP32S3) || defined(CONFIG_IDF_TARGET_ESP32C3)
#include "esp_wifi.h"
#include "WiFi.h"

  const char *ntpServer = "time.cloudflare.com";
  const char *ssid     = "YOUR_SSID";
  const char *password = "YOUR_PASSWORD";
#elif defined(ARDUINO_SEEED_XIAO_NRF52840_SENSE) || defined(ARDUINO_SEEED_XIAO_NRF52840)
#error "æ­¤ç¨‹åºä¸é€‚ç”¨äºXIAO nRF52840ç³»åˆ—ï¼Œè¯·æ›´æ¢å…¶ä»–XIAOå¹¶é‡è¯•ã€‚"
#endif


//TFT_eSPI tft = TFT_eSPI();  // è°ƒç”¨åº“ï¼Œå¼•è„šåœ¨User_Setup.hä¸­å®šä¹‰
TFT_eSprite face = TFT_eSprite(&tft);

#define CLOCK_X_POS 0
#define CLOCK_Y_POS 0

#define CLOCK_FG   TFT_SKYBLUE
#define CLOCK_BG   TFT_NAVY
#define SECCOND_FG TFT_RED
#define LABEL_FG   TFT_GOLD

#define CLOCK_R       240.0f / 2.0f // æ—¶é’Ÿè¡¨é¢åŠå¾„ï¼ˆæµ®ç‚¹ç±»å‹ï¼‰
#define H_HAND_LENGTH CLOCK_R/2.0f
#define M_HAND_LENGTH CLOCK_R/1.4f
#define S_HAND_LENGTH CLOCK_R/1.3f

// è®¡ç®—1ç§’å¢é‡è§’åº¦ã€‚æ—¶é’ˆå’Œåˆ†é’ˆè§’åº¦
// æ¯ç§’éƒ½ä¼šæ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¹³æ»‘çš„äºšåƒç´ ç§»åŠ¨
#define SECOND_ANGLE 360.0 / 60.0
#define MINUTE_ANGLE SECOND_ANGLE / 60.0
#define HOUR_ANGLE   MINUTE_ANGLE / 12.0

// ç²¾çµå®½åº¦å’Œé«˜åº¦
#define FACE_W CLOCK_R * 2 + 1
#define FACE_H CLOCK_R * 2 + 1

// æ—¶é—´ h:m:s
uint8_t h = 0, m = 0, s = 0;

float time_secs = h * 3600 + m * 60 + s;

// ä¸‹æ¬¡åˆ·æ–°çš„æ—¶é—´
uint32_t targetTime = 0;

// =========================================================================
// è®¾ç½®
// =========================================================================
void setup() {
  Serial.begin(115200);
  Serial.println("å¯åŠ¨ä¸­...");

  // åˆå§‹åŒ–å±å¹•
  tft.init();

  // ç†æƒ³æƒ…å†µä¸‹è®¾ç½®æ–¹å‘ä»¥è·å¾—è‰¯å¥½çš„è§†è§’èŒƒå›´ï¼Œå› ä¸º
  // æŠ—é”¯é½¿æ•ˆæœéšå±å¹•è§†è§’è€Œå˜åŒ–
  // é€šå¸¸è¿™æ˜¯å½“å±å¹•æ’çº¿è¿æ¥å™¨åœ¨åº•éƒ¨æ—¶
  tft.setRotation(0);
  tft.fillScreen(TFT_BLACK);

  // åˆ›å»ºæ—¶é’Ÿè¡¨é¢ç²¾çµ
  //face.setColorDepth(8); // 8ä½å¯ä»¥å·¥ä½œï¼Œä½†ä¼šé™ä½æŠ—é”¯é½¿çš„æ•ˆæœ
  face.createSprite(FACE_W, FACE_H);

  // ç»˜åˆ¶æ•´ä¸ªæ—¶é’Ÿ - NTPæ—¶é—´å°šä¸å¯ç”¨
  renderFace(time_secs);

#if defined(CONFIG_IDF_TARGET_ESP32S3) || defined(CONFIG_IDF_TARGET_ESP32C3)
  WiFi.begin(ssid, password);
  while ( WiFi.status() != WL_CONNECTED ) 
  {
    delay ( 500 );
    Serial.print ( "." );
  }
  configTime(8 * 3600, 0, ntpServer);
#endif

  Wire.begin();
  rtc.begin();

//  struct tm timeInfo;
  I2C_BM8563_TimeTypeDef timeStruct;
  I2C_BM8563_DateTypeDef dateStruct;

// å¯¹äºXIAO ESP32ç³»åˆ—ï¼Œä½¿ç”¨ç½‘ç»œæ—¶é—´ã€‚
#if defined(CONFIG_IDF_TARGET_ESP32S3) || defined(CONFIG_IDF_TARGET_ESP32C3)
  struct tm timeInfo;
  if (getLocalTime(&timeInfo)) {
    timeStruct.hours   = timeInfo.tm_hour;
    timeStruct.minutes = timeInfo.tm_min;
    timeStruct.seconds = timeInfo.tm_sec;
    rtc.setTime(&timeStruct);
  }
#else
  // è®¾ç½®RTCæ—¶é—´ï¼Œå…¶ä»–XIAOæ²¡æœ‰ç½‘ç»œåŠŸèƒ½ï¼Œéœ€è¦æ‰‹åŠ¨å¯¹æ—¶ã€‚
  // è¯·æ³¨æ„ï¼Œè®¾ç½®æ—¶é—´åº”è¯¥åªè®¾ç½®ä¸€æ¬¡ã€‚
  timeStruct.hours   = 9;
  timeStruct.minutes = 43;
  timeStruct.seconds = 10;
  rtc.setTime(&timeStruct);
#endif

  targetTime = millis() + 100;
  rtc.getTime(&timeStruct);
  time_secs = timeStruct.hours * 3600 + timeStruct.minutes * 60 + timeStruct.seconds;
}

// =========================================================================
// å¾ªç¯
// =========================================================================
void loop() {
  // å®šæœŸæ›´æ–°æ—¶é—´
  if (targetTime < millis()) {

    // åœ¨100æ¯«ç§’å†…æ›´æ–°ä¸‹æ¬¡åˆ·æ–°æ—¶é—´ä»¥å®ç°å¹³æ»‘ç§»åŠ¨
    targetTime = millis() + 100;

    // æ—¶é—´å¢åŠ 100æ¯«ç§’
    time_secs += 0.100;

    // åˆå¤œç¿»è½¬
    if (time_secs >= (60 * 60 * 24)) time_secs = 0;

    // æ‰€æœ‰å›¾å½¢éƒ½åœ¨ç²¾çµä¸­ç»˜åˆ¶ä»¥é˜²æ­¢é—ªçƒ
    renderFace(time_secs);

    I2C_BM8563_DateTypeDef dateStruct;
    I2C_BM8563_TimeTypeDef timeStruct;

    // è·å–RTC
    rtc.getTime(&timeStruct);
  
    // æ‰“å°RTC
#if defined(CONFIG_IDF_TARGET_ESP32S3) || defined(CONFIG_IDF_TARGET_ESP32C3)
    Serial.printf("%02d:%02d:%02d\n",
                timeStruct.hours,
                timeStruct.minutes,
                timeStruct.seconds
               );
#else
     Serial.print(timeStruct.hours);
     Serial.print(", ");
     Serial.print(timeStruct.minutes);
     Serial.print(", ");
     Serial.print(timeStruct.seconds);
     Serial.println();
#endif
  }
}

// =========================================================================
// åœ¨ç²¾çµä¸­ç»˜åˆ¶æ—¶é’Ÿè¡¨é¢
// =========================================================================
static void renderFace(float t) {
  float h_angle = t * HOUR_ANGLE;
  float m_angle = t * MINUTE_ANGLE;
  float s_angle = t * SECOND_ANGLE;

  // è¡¨é¢å®Œå…¨é‡ç»˜ - è¿™å¯ä»¥å¿«é€Ÿå®Œæˆ
  face.fillSprite(TFT_BLACK);

  // ç»˜åˆ¶è¡¨é¢åœ†åœˆ
  face.fillSmoothCircle( CLOCK_R, CLOCK_R, CLOCK_R, CLOCK_BG );

  // è®¾ç½®æ–‡æœ¬åŸºå‡†ä¸ºä¸­å¿ƒå¹¶è®¾ç½®é¢œè‰²
  face.setTextDatum(MC_DATUM);

  // åœ¨å­—ç¬¦æ¸²æŸ“æœŸé—´å°†è¯»å–èƒŒæ™¯é¢œè‰²
  face.setTextColor(CLOCK_FG, CLOCK_BG);

  // æ–‡æœ¬åç§»è°ƒæ•´
  constexpr uint32_t dialOffset = CLOCK_R - 10;

  float xp = 0.0, yp = 0.0; // ä½¿ç”¨æµ®ç‚¹åƒç´ ä½ç½®å®ç°å¹³æ»‘AAè¿åŠ¨

  // åœ¨æ—¶é’Ÿå‘¨å›´ç»˜åˆ¶æ•°å­—
  for (uint32_t h = 1; h <= 12; h++) {
    getCoord(CLOCK_R, CLOCK_R, &xp, &yp, dialOffset, h * 360.0 / 12);
    face.drawNumber(h, xp, 2 + yp);
  }

  // æ·»åŠ æ–‡æœ¬ï¼ˆå¯ä»¥æ˜¯æ•°å­—æ—¶é—´...ï¼‰
  face.setTextColor(LABEL_FG, CLOCK_BG);
  face.drawString("TFT_eSPI", CLOCK_R, CLOCK_R * 0.75);

  // ç»˜åˆ¶åˆ†é’ˆ
  getCoord(CLOCK_R, CLOCK_R, &xp, &yp, M_HAND_LENGTH, m_angle);
  face.drawWideLine(CLOCK_R, CLOCK_R, xp, yp, 6.0f, CLOCK_FG);
  face.drawWideLine(CLOCK_R, CLOCK_R, xp, yp, 2.0f, CLOCK_BG);

  // ç»˜åˆ¶æ—¶é’ˆ
  getCoord(CLOCK_R, CLOCK_R, &xp, &yp, H_HAND_LENGTH, h_angle);
  face.drawWideLine(CLOCK_R, CLOCK_R, xp, yp, 6.0f, CLOCK_FG);
  face.drawWideLine(CLOCK_R, CLOCK_R, xp, yp, 2.0f, CLOCK_BG);

  // ç»˜åˆ¶ä¸­å¿ƒæ¢è½´åœ†åœˆ
  face.fillSmoothCircle(CLOCK_R, CLOCK_R, 4, CLOCK_FG);

  // ç»˜åˆ¶ç§’é’ˆ
  getCoord(CLOCK_R, CLOCK_R, &xp, &yp, S_HAND_LENGTH, s_angle);
  face.drawWedgeLine(CLOCK_R, CLOCK_R, xp, yp, 2.5, 1.0, SECCOND_FG);
  face.pushSprite(0, 0, TFT_TRANSPARENT);
}

// =========================================================================
// è·å–çº¿æ¡æœ«ç«¯çš„åæ ‡ï¼Œä»¥x,yä¸ºæ¢è½´ï¼Œé•¿åº¦rï¼Œè§’åº¦a
// =========================================================================
// åæ ‡é€šè¿‡xpå’ŒypæŒ‡é’ˆè¿”å›ç»™è°ƒç”¨è€…
#define DEG2RAD 0.0174532925
void getCoord(int16_t x, int16_t y, float *xp, float *yp, int16_t r, float a)
{
  float sx1 = cos( (a - 90) * DEG2RAD);
  float sy1 = sin( (a - 90) * DEG2RAD);
  *xp =  sx1 * r + x;
  *yp =  sy1 * r + y;
}
```

ä¸Šè¿°ä»£ç éœ€è¦æ ¹æ®æ‚¨ä½¿ç”¨çš„å¼€å‘æ¿ç±»å‹è¿›è¡Œä¸€äº›å°çš„ä¿®æ”¹ã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯å…·æœ‰ç½‘ç»œåŠŸèƒ½çš„ XIAOï¼Œæ‚¨éœ€è¦é…ç½® WiFi åç§°å’Œå¯†ç ã€‚å¦‚æœæ²¡æœ‰ï¼Œæ‚¨éœ€è¦æ‰‹åŠ¨è°ƒæ•´å®æ—¶æ—¶é—´ã€‚

ä¸Šä¼ ç¨‹åºåï¼Œæ‚¨å°†çœ‹åˆ°è¡¨ç›˜æ ¹æ®è®¾å®šçš„æ—¶é—´è‡ªåŠ¨è¿è¡Œã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/75.gif" style={{width:500, height:'auto'}}/></div>

## SD å¡åŠŸèƒ½

Round Display æ”¯æŒä½¿ç”¨ microSD å¡æ¥è¯»å†™æ•°æ®ã€‚åœ¨ä½¿ç”¨ microSD å¡ä¹‹å‰ï¼Œè¯·å°† microSD å¡æ ¼å¼åŒ–ä¸º **FAT32** æ ¼å¼ï¼Œä»¥ç¡®ä¿å®ƒèƒ½å¤Ÿè¢«æ­£ç¡®è¯†åˆ«å’Œä½¿ç”¨ã€‚

### æ‰€æœ‰ XIAO ç³»åˆ—ï¼ˆé™¤äº† XIAO nRF52840 ç³»åˆ—ï¼‰

æœ¬èŠ‚é€‚ç”¨äºæ‰€æœ‰ XIAOï¼ˆé™¤äº† XIAO nRF52840 ç³»åˆ—ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºè¯»å†™æ–‡ä»¶çš„ç®€å•ç¨‹åºã€‚

```cpp
#include <SPI.h>
#include <SD.h>
#include <TFT_eSPI.h>

TFT_eSPI tft = TFT_eSPI();

File myFile;

void setup() {
  // Open serial communications and wait for port to open:
  Serial.begin(115200);
  while(!Serial);

  // Display initialization
  tft.init();

  Serial.print("Initializing SD card...");

  pinMode(D2, OUTPUT);
  if (!SD.begin(D2)) {
    Serial.println("initialization failed!");
    return;
  }
  Serial.println("initialization done.");

  // open the file. note that only one file can be open at a time,
  // so you have to close this one before opening another.
  myFile = SD.open("/test.txt", FILE_WRITE);

  // if the file opened okay, write to it:
  if (myFile) {
    Serial.print("Writing to test.txt...");
    myFile.println("testing 1, 2, 3.");
    // close the file:
    myFile.close();
    Serial.println("done.");
  } else {
    // if the file didn't open, print an error:
    Serial.println("error opening test.txt");
  }

  // re-open the file for reading:
  myFile = SD.open("/test.txt");
  if (myFile) {
    Serial.println("test.txt:");

    // read from the file until there's nothing else in it:
    while (myFile.available()) {
      Serial.write(myFile.read());
    }
    // close the file:
    myFile.close();
  } else {
    // if the file didn't open, print an error:
    Serial.println("error opening test.txt");
  }
}

void loop() {
  // nothing happens after setup
}
```

è¿™ä¸ªç¨‹åºå°†åœ¨æ‚¨çš„microSDå¡ä¸Šåˆ›å»ºä¸€ä¸ªåä¸º**test.txt**çš„æ–°ç¨‹åºï¼Œå¹¶å†™å…¥**testing 1, 2, 3.**çš„å†…å®¹ã€‚æœ€åï¼Œå®ƒè¯»å–æ–‡ä»¶å¹¶é€šè¿‡ä¸²å£ç›‘è§†å™¨æ‰“å°å‡ºæ–‡ä»¶çš„å†…å®¹ã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/83.png" style={{width:700, height:'auto'}}/></div>

:::caution
æ‚¨ä¼šå‘ç°ç¨‹åºä¸­ä½¿ç”¨äº†å±å¹•TFTåˆå§‹åŒ–æ¥é…åˆSDå¡ä½¿ç”¨ã€‚è¯·ä¸è¦è®¤ä¸ºè¿™æ˜¯æ— ç”¨çš„å¯ä»¥åˆ é™¤ï¼Œä½†å®é™…ä¸Šä½¿ç”¨SDå¡æ˜¯å¿…éœ€çš„ï¼Œå¦åˆ™æ‚¨ä¼šæ”¶åˆ°microSDå¡æŒ‚è½½å¤±è´¥çš„é”™è¯¯æ¶ˆæ¯ã€‚

ç”±äºç¡¬ä»¶è®¾è®¡ï¼Œä¸€äº›å¼•è„šé»˜è®¤ä¸ºä½ç”µå¹³ï¼Œè¿™ä¼šå¯¼è‡´microSDæŒ‚è½½ç¨‹åºè®¤ä¸ºæ²¡æœ‰ä¸Šæ‹‰ç”µé˜»ä»è€Œå¯¼è‡´æŒ‚è½½å¤±è´¥ã€‚å› æ­¤ï¼Œåœ¨Round Displayä¸Šä½¿ç”¨SDå¡åŠŸèƒ½æ—¶ï¼Œè¯·ç¡®ä¿åœ¨åˆå§‹åŒ–SDå¡ä¹‹å‰å…ˆåˆå§‹åŒ–å±å¹•æ˜¾ç¤ºã€‚
:::

### XIAO nRF52840

å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯XIAO nRF52840ç³»åˆ—ï¼Œé‚£ä¹ˆæ‚¨å¯èƒ½éœ€è¦å•ç‹¬ä¸‹è½½[SdFatåº“](https://github.com/greiman/SdFat)æ‰èƒ½ä½¿ç”¨SDå¡åŠŸèƒ½ã€‚

```cpp
#include <SPI.h>
#include "SdFat.h"
#include <TFT_eSPI.h>

TFT_eSPI tft = TFT_eSPI();
SdFat SD;

#define SD_CS_PIN D2
File myFile;

void setup() {
  // Open serial communications and wait for port to open:
  Serial.begin(9600);
  while (!Serial) {
    ; // wait for serial port to connect. Needed for native USB port only
  }

  // Display initialization
  tft.init();

  Serial.print("Initializing SD card...");

  if (!SD.begin(SD_CS_PIN)) {
    Serial.println("initialization failed!");
    return;
  }
  Serial.println("initialization done.");

  // open the file. note that only one file can be open at a time,
  // so you have to close this one before opening another.
  myFile = SD.open("/test.txt", FILE_WRITE);

  // if the file opened okay, write to it:
  if (myFile) {
    Serial.print("Writing to test.txt...");
    myFile.println("testing 1, 2, 3.");
    // close the file:
    myFile.close();
    Serial.println("done.");
  } else {
    // if the file didn't open, print an error:
    Serial.println("error opening test.txt");
  }

  // re-open the file for reading:
  myFile = SD.open("test.txt");
  if (myFile) {
    Serial.println("test.txt:");

    // read from the file until there's nothing else in it:
    while (myFile.available()) {
      Serial.write(myFile.read());
    }
    // close the file:
    myFile.close();
  } else {
    // if the file didn't open, print an error:
    Serial.println("error opening test.txt");
  }
}

void loop() {
  // nothing happens after setup
}
```

### XIAO ESP32S3 & XIAO ESP32S3 Sense & XIAO ESP32C3

ç”±äºESP32ç³»åˆ—å…·æœ‰éå¸¸å¼ºå¤§çš„æ–‡ä»¶ç³»ç»Ÿæ”¯æŒï¼Œæˆ‘ä»¬ä¸ºXIAO ESP32ç¼–å†™äº†ä¸€ç³»åˆ—å…³äºå¦‚ä½•ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿå’Œä¿å­˜microSDå¡çš„ç¤ºä¾‹ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹é“¾æ¥å­¦ä¹ ä½¿ç”¨ã€‚

- **[æ–‡ä»¶ç³»ç»Ÿå’ŒXIAO ESP32S3 Sense](https://wiki.seeedstudio.com/cn/xiao_esp32s3_sense_filesystem)**

æœ¬Wikiä¸­çš„æ•™ç¨‹é€‚ç”¨äºXIAO ESP32ç³»åˆ—ï¼Œä½†ç”±äºæ‚¨ç°åœ¨æƒ³è¦ä½¿ç”¨Round Displayçš„SDå¡æ’æ§½ï¼Œè€Œä¸Šè¿°æ•™ç¨‹ä¸“æ³¨äºä½¿ç”¨XIAO ESP32S3 Senseä¸Šçš„SDå¡æ’æ§½ï¼Œæ‚¨éœ€è¦å°†SDå¡çš„åˆå§‹åŒ–ä¿®æ”¹ä¸ºä»¥ä¸‹ä»£ç è¡Œã€‚

```c
// Display initialization
tft.init();

pinMode(D2, OUTPUT);
SD.begin(D2);
```

:::tip
ä¸è¦å¿˜è®°ï¼Œæ‚¨è¿˜éœ€è¦å…ˆåˆå§‹åŒ–TFTå±å¹•æ‰èƒ½ä½¿ç”¨SDå¡åŠŸèƒ½ã€‚
:::

## å±å¹•åŠŸèƒ½

åœ¨å±å¹•çš„ä½¿ç”¨éƒ¨åˆ†ï¼Œä¸»è¦åˆ†ä¸ºè§¦æ‘¸å’Œæ˜¾ç¤ºä¸¤ä¸ªç»„ä»¶ã€‚

### è§¦æ‘¸åŠŸèƒ½

è§¦æ‘¸åŠŸèƒ½æ˜¯Round Displayçš„ç‰¹æ®ŠåŠŸèƒ½ã€‚æ‚¨å¯ä»¥ä½¿ç”¨è§¦æ‘¸åŠŸèƒ½æ¥æ‰§è¡Œä¸€äº›ç‚¹å‡»å’Œé•¿æŒ‰æ˜¾ç¤ºæ“ä½œã€‚

ä»¥ä¸‹ç¨‹åºå¯ç”¨äºè¾“å‡ºæ˜¾ç¤ºå±æ˜¯å¦è¢«è§¦æ‘¸çš„ç»“æœã€‚

```cpp
#define USE_TFT_ESPI_LIBRARY
#include "lv_xiao_round_screen.h"

void setup() {
  // put your setup code here, to run once:
  Serial.begin(115200);
  pinMode(TOUCH_INT, INPUT_PULLUP);
  Wire.begin();
}

void loop() {
  // put your main code here, to run repeatedly:
  if(chsc6x_is_pressed()){
    Serial.println("The display is touched.");
  }
  else
    Serial.println("The display is not touched.");
  delay(50);
}
```

ä»¥ä¸‹ç¨‹åºæ˜¯è§¦æ‘¸åŠŸèƒ½ä¸æ˜¾ç¤ºåŠŸèƒ½ç»“åˆçš„ç®€å•ç¤ºä¾‹ã€‚ä¸Šä¼ ä»¥ä¸‹ç¨‹åºï¼Œç„¶åç‚¹å‡»å±å¹•ï¼Œå°†åœ¨å±å¹•è¢«ç‚¹å‡»çš„ä½ç½®ç»˜åˆ¶ä¸€ä¸ªå°åœ†åœˆã€‚

:::caution
å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ XIAO nRF52840ï¼Œé‚£ä¹ˆä»¥ä¸‹åŸºäº TFT åº“æ˜¾ç¤ºçš„ç¨‹åºå¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œï¼Œæ‚¨éœ€è¦ä¿®æ”¹ç¨‹åºä»¥ä½¿ç”¨ Arduino GFX åº“ã€‚
:::

```cpp
#include <TFT_eSPI.h>
#include <SPI.h>
#define USE_TFT_ESPI_LIBRARY
#include "lv_xiao_round_screen.h"

lv_coord_t touchX, touchY;

void setup() {
  // put your setup code here, to run once:
  Serial.begin(115200);

  pinMode(TOUCH_INT, INPUT_PULLUP);
  Wire.begin();
  
  // Initialise the screen
  tft.init();

  tft.setRotation(0);
  tft.fillScreen(TFT_BLACK);
}

void loop() {
  // put your main code here, to run repeatedly:
  if(chsc6x_is_pressed())
  {
    Serial.println("The display is touched.");
    chsc6x_get_xy(&touchX, &touchY);
    tft.drawCircle(touchX, touchY, 15, TFT_WHITE);
  }
  
  delay(50);
}
```

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/81.gif" style={{width:500, height:'auto'}}/></div>

### æ˜¾ç¤ºåŠŸèƒ½

å…³äºæ˜¾ç¤ºéƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¸»è¦ä»‹ç» LVGL åº“å’Œ TFT åº“çš„ä½¿ç”¨ã€‚ç”±äºç¯‡å¹…é—®é¢˜ï¼Œæˆ‘ä»¬å°†åœ¨æ–°çš„ Wiki ä¸­è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨æ”¯æŒçš„å›¾å½¢åº“ç»˜åˆ¶å¤æ‚çš„è¡¨ç›˜ã€‚

[åœ¨ Seeed Studio Round Display for XIAO ä¸Šä½¿ç”¨ LVGL å’Œ TFT](https://wiki.seeedstudio.com/cn/using_lvgl_and_tft_on_round_display)

å½“ç„¶ï¼Œå¦‚æœæ‚¨åªæƒ³å®ç°ä¸€äº›ç®€å•çš„ç¤ºä¾‹ï¼Œå›¾å½¢åº“ä¹Ÿæœ‰éå¸¸ä¸°å¯Œçš„ç¤ºä¾‹ä¾›æ‚¨å‚è€ƒä½¿ç”¨ã€‚

- [TFT åº“ç¤ºä¾‹](https://github.com/Bodmer/TFT_eSPI/tree/master/examples)

- [Arduino GFX åº“ç¤ºä¾‹](https://github.com/moononournation/Arduino_GFX/tree/master/examples)

- [LVGL åº“ç¤ºä¾‹](https://github.com/lvgl/lvgl/tree/master/examples)

å¦‚æœæ‚¨å·²ç»å®‰è£…äº†è¿™äº›åº“ï¼Œæ‚¨å¯ä»¥åœ¨ Arduino IDE çš„ **æ–‡ä»¶->ç¤ºä¾‹->åº“åç§°** ä¸­è½»æ¾æ‰¾åˆ°ç¤ºä¾‹ã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/82.png" style={{width:800, height:'auto'}}/></div>

:::tip
è¿™é‡Œçš„ç¤ºä¾‹ä»…ä¾›å‚è€ƒï¼Œå¹¶éæ¯ä¸ªç¤ºä¾‹éƒ½ä¸€å®šèƒ½æ­£å¸¸å·¥ä½œã€‚æ‚¨å¯èƒ½éœ€è¦ä¿®æ”¹ç¨‹åºä»¥å…¼å®¹åœ†å½¢æ˜¾ç¤ºå±çš„å¼•è„šåˆ†é…å’Œç¡¬ä»¶å®šä¹‰ã€‚
:::


## æŠ€æœ¯æ”¯æŒä¸äº§å“è®¨è®º

### Q1ï¼šä¸ºä»€ä¹ˆæˆ‘ä½¿ç”¨ XIAO nRF52840 (Sense) æ—¶ä¼šå‡ºç°é”™è¯¯ï¼Ÿ

åœ¨ä½¿ç”¨æœ¬æ•™ç¨‹å†…å®¹æ—¶ï¼ŒXIAO nRF52840 å¯èƒ½ä¼šå‡ºç°ä¸¤ç§ä¸åŒç±»å‹çš„é—®é¢˜ã€‚

1. nRF52840 ä¸ TFT åº“ä¹‹é—´çš„å…¼å®¹æ€§é—®é¢˜ã€‚

  å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ TFT åº“ï¼Œç¼–è¯‘å’Œä¸Šä¼ æ²¡æœ‰ä»»ä½•é”™è¯¯ï¼Œéå¸¸é¡ºåˆ©ã€‚ä½†æ˜¯å½“æ‚¨æ˜¾ç¤ºæ—¶ï¼Œå‘ç°æ²¡æœ‰å›¾åƒã€‚é‚£ä¹ˆæ‚¨å¯èƒ½é‡åˆ°äº† nRF52840 ä¸ TFT åº“ä¹‹é—´çš„å…¼å®¹æ€§é—®é¢˜ã€‚è¿™æ„å‘³ç€æ‚¨åªèƒ½æ›´æ¢ XIAO æˆ–ä½¿ç”¨ Arduino GFX åº“æ¥å®Œæˆå›¾åƒæ˜¾ç¤ºã€‚

2. é€‰æ‹©é”™è¯¯çš„å¼€å‘æ¿å¯¼è‡´çš„ç¼–è¯‘é”™è¯¯ã€‚

å¦‚æœæ‚¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ã€‚é”™è¯¯æ¶ˆæ¯é€šå¸¸æ˜¯å…³äº SPI é”™è¯¯ï¼Œä¾‹å¦‚ `'SPI_X' was not declared in this scope`ã€‚é‚£ä¹ˆè¿™æ„å‘³ç€æ‚¨é€‰æ‹©äº†é”™è¯¯ç±»å‹çš„å¼€å‘æ¿ã€‚è¦ä½¿ç”¨æœ¬æ•™ç¨‹çš„æ‰€æœ‰å†…å®¹ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ XIAO nRF52840 çš„ **é mbed** ç‰ˆæœ¬ã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/73.png" style={{width:700, height:'auto'}}/></div>

### Q2ï¼šä¸º XIAO RP2040 ä¸Šä¼ ç¨‹åºæ—¶å‡ºç°é”™è¯¯ï¼šunaligned opcodes detected in executable segmentï¼Ÿ

è¯·æ ¹æ®ä¸‹å›¾ä¸­çš„è®¾ç½®ä¿®æ”¹ XIAO RP2040 çš„ä¸Šä¼ é€‰é¡¹ã€‚é™¤äº†é»˜è®¤çš„ **Small (-Os) (standard)** ä¹‹å¤–ï¼Œæ‰€æœ‰é€‰é¡¹éƒ½å¯ä»¥æ­£å¸¸å·¥ä½œã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/74.png" style={{width:600, height:'auto'}}/></div>

### Q3ï¼šä¸ºä»€ä¹ˆæˆ‘ä¸º XIAO SAMD21 ç¼–è¯‘åœ†å½¢å±å¹•ç¨‹åºæ—¶ä¼šå‡ºç°å¼•è„šå®šä¹‰é”™è¯¯ï¼Ÿ

å½“æ‚¨é‡åˆ°æ­¤é”™è¯¯æ—¶ï¼Œè¯·å°†æ‚¨çš„ **Seeed SAMD** å¼€å‘æ¿æ¿è½½åŒ…æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚

<div style={{textAlign:'center'}}><img src="https://files.seeedstudio.com/wiki/round_display_for_xiao/76.png" style={{width:700, height:'auto'}}/></div>

### Q4ï¼šä¸ºä»€ä¹ˆæˆ‘å°†ç¨‹åºä¸Šä¼ åˆ° XIAO ESP32C3 åå±å¹•ä¸æ˜¾ç¤ºï¼Ÿ

å¦‚æœç¨‹åºæ²¡æœ‰é—®é¢˜ä½†ä¸Šä¼ åä¸æ˜¾ç¤ºï¼Œå¯èƒ½æ˜¯éœ€è¦é‡ç½®ã€‚åªéœ€æŒ‰ä¸‹ XIAO ESP32C3 ä¸Šçš„é‡ç½®æŒ‰é’®å³å¯ã€‚


## æŠ€æœ¯æ”¯æŒä¸äº§å“è®¨è®º

æ„Ÿè°¢æ‚¨é€‰æ‹©æˆ‘ä»¬çš„äº§å“ï¼æˆ‘ä»¬åœ¨è¿™é‡Œä¸ºæ‚¨æä¾›ä¸åŒçš„æ”¯æŒï¼Œä»¥ç¡®ä¿æ‚¨ä½¿ç”¨æˆ‘ä»¬äº§å“çš„ä½“éªŒå°½å¯èƒ½é¡ºç•…ã€‚æˆ‘ä»¬æä¾›å¤šç§æ²Ÿé€šæ¸ é“ï¼Œä»¥æ»¡è¶³ä¸åŒçš„åå¥½å’Œéœ€æ±‚ã€‚

<div class="button_tech_support_container">
<a href="https://forum.seeedstudio.com/" class="button_forum"></a> 
<a href="https://www.seeedstudio.com/contacts" class="button_email"></a>
</div>

<div class="button_tech_support_container">
<a href="https://discord.gg/eWkprNDMU7" class="button_discord"></a> 
<a href="https://github.com/Seeed-Studio/wiki-documents/discussions/69" class="button_discussion"></a>
</div>